<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Mini Chat (Practice) — Login with Facebook (mock)</title>
  <style>
    :root{
      --bg:#0f1724;
      --card:#0b1220;
      --accent:#1877f2;
      --muted:#9aa4b2;
      --me:#18304a;
      --you:#12312c;
      --glass: rgba(255,255,255,0.03);
      --radius:12px;
      --maxw:900px;
    }
    *{box-sizing:border-box;font-family:Inter,system-ui,Segoe UI,Roboto,"Helvetica Neue",Arial;}
    html,body{height:100%;margin:0;background:linear-gradient(180deg,#071029 0%, #071826 100%);color:#e6eef8}
    .wrap{max-width:var(--maxw);margin:28px auto;padding:20px;}
    .top{
      display:flex;align-items:center;gap:16px;margin-bottom:16px;
    }
    .brand{
      display:flex;gap:12px;align-items:center;
    }
    .logo{
      width:52px;height:52px;border-radius:10px;background:linear-gradient(135deg,var(--accent),#5aa0ff);display:flex;align-items:center;justify-content:center;font-weight:700;font-size:20px;color:white;box-shadow:0 6px 18px rgba(24,119,242,0.18);
    }
    h1{font-size:18px;margin:0}
    p.sub{margin:0;color:var(--muted);font-size:13px}
    .controls{margin-left:auto;display:flex;gap:10px;align-items:center;}
    .btn{
      background:var(--accent);color:white;padding:8px 12px;border-radius:10px;border:0;cursor:pointer;font-weight:600;box-shadow:0 6px 18px rgba(24,119,242,0.12)
    }
    .ghost{
      background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted);padding:8px 10px;border-radius:10px;cursor:pointer;
    }
    .card{
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:16px;border-radius:var(--radius);backdrop-filter: blur(6px);box-shadow:0 10px 30px rgba(2,6,23,0.6);
      display:grid;grid-template-columns:260px 1fr;gap:16px;
    }
    /* Left sidebar (users / info) */
    .sidebar{
      border-radius:10px;padding:12px;background:var(--card);min-height:420px;
    }
    .userbox{display:flex;gap:12px;align-items:center;margin-bottom:12px}
    .avatar{width:52px;height:52px;border-radius:12px;background:linear-gradient(135deg,#3b82f6,#60a5fa);display:flex;align-items:center;justify-content:center;font-weight:700;color:white}
    .user-meta{font-size:13px}
    .user-meta .name{font-weight:700}
    .user-meta .email{color:var(--muted);font-size:12px}
    .login-hint{margin-top:6px;color:var(--muted);font-size:13px}
    .u-list{margin-top:14px}
    .u-item{display:flex;gap:10px;align-items:center;padding:8px;border-radius:8px;cursor:default}
    .u-item small{color:var(--muted);font-size:12px}
    /* chat area */
    .chat-area{background:transparent;min-height:420px;display:flex;flex-direction:column}
    .messages{flex:1;overflow:auto;padding:12px;border-radius:10px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));border:1px solid rgba(255,255,255,0.02)}
    .msg{display:flex;gap:10px;margin-bottom:12px;align-items:flex-end}
    .msg.me{justify-content:flex-end}
    .bubble{
      max-width:70%;padding:10px 12px;border-radius:12px;background:var(--glass);font-size:14px;color:#e6eef8;line-height:1.3;
      box-shadow:0 6px 20px rgba(2,6,23,0.6);
    }
    .bubble.me{background:linear-gradient(180deg,var(--me),#082034);border:1px solid rgba(255,255,255,0.03)}
    .meta{font-size:11px;color:var(--muted);margin-bottom:6px}
    .input-row{display:flex;gap:8px;padding-top:12px}
    .input{
      flex:1;padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit;outline:none;font-size:14px;
    }
    .send{padding:10px 14px;border-radius:10px;border:0;background:linear-gradient(90deg,var(--accent),#4aa3ff);color:white;font-weight:700;cursor:pointer}
    .small{font-size:12px;color:var(--muted)}
    footer.hint{margin-top:8px;color:var(--muted);font-size:13px}
    @media (max-width:820px){
      .card{grid-template-columns:1fr; }
      .sidebar{order:2}
      .chat-area{order:1}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="top">
      <div class="brand">
        <div class="logo">CG</div>
        <div>
          <h1>Mini Chat — Practice</h1>
          <p class="sub">Static demo + mock "Login with Facebook" for learning</p>
        </div>
      </div>

      <div class="controls">
        <button id="fbLoginBtn" class="btn">Login with Facebook</button>
        <button id="logoutBtn" class="ghost" style="display:none">Logout</button>
      </div>
    </div>

    <div class="card">
      <aside class="sidebar">
        <div class="userbox">
          <div id="leftAvatar" class="avatar">?</div>
          <div class="user-meta">
            <div id="leftName" class="name">Not signed in</div>
            <div id="leftEmail" class="email">Use "Login with Facebook" to continue</div>
            <div class="login-hint small">This is a mock login for practice only.</div>
          </div>
        </div>

        <div class="u-list">
          <div class="small" style="margin-bottom:8px">Active users</div>
          <div class="u-item"><div class="avatar" style="width:36px;height:36px;font-size:13px">ME</div><div><strong>You (local)</strong><br><small>mock user</small></div></div>
          <div class="u-item"><div class="avatar" style="width:36px;height:36px;font-size:13px;background:linear-gradient(135deg,#ff8a65,#ffb86b)">AN</div><div><strong>Ana</strong><br><small>friend</small></div></div>
        </div>
      </aside>

      <section class="chat-area">
        <div class="messages" id="messages" aria-live="polite"></div>

        <div style="padding-top:10px">
          <div class="input-row">
            <input id="textInput" class="input" placeholder="Type a message..." autocomplete="off" />
            <button id="sendBtn" class="send">Send</button>
          </div>
          <div class="hint small">Messages persist locally (localStorage). This demo doesn't send data to a server.</div>
        </div>
      </section>
    </div>

    <footer class="hint">
      <p class="small">Tip: Click <strong>Login with Facebook</strong> to auto-fill a demo profile (mock). To integrate real Facebook login you'd need to create a Facebook App and follow their OAuth flow — see comments in the script below.</p>
    </footer>
  </div>

  <script>
    // ====== Mini Chat (static + mock FB login) ======
    // Data model saved in localStorage:
    // localStorage.chat_user -> JSON {name,email,avatar}
    // localStorage.chat_messages -> JSON array [{id,from,name,text,ts}]
    (() => {
      const messagesEl = document.getElementById('messages');
      const input = document.getElementById('textInput');
      const sendBtn = document.getElementById('sendBtn');
      const fbBtn = document.getElementById('fbLoginBtn');
      const logoutBtn = document.getElementById('logoutBtn');

      function uid() {
        return Math.random().toString(36).slice(2,9);
      }

      function loadUser(){
        try{
          const raw = localStorage.getItem('chat_user');
          return raw ? JSON.parse(raw) : null;
        }catch(e){return null;}
      }

      function saveUser(u){
        localStorage.setItem('chat_user', JSON.stringify(u));
        renderUser(u);
      }

      function clearUser(){
        localStorage.removeItem('chat_user');
        renderUser(null);
      }

      function loadMessages(){
        try{
          const raw = localStorage.getItem('chat_messages');
          return raw ? JSON.parse(raw) : [];
        }catch(e){return [];}
      }

      function saveMessages(arr){
        localStorage.setItem('chat_messages', JSON.stringify(arr));
      }

      function addMessage(msg){
        const arr = loadMessages();
        arr.push(msg);
        saveMessages(arr);
        renderMessages();
      }

      function formatTime(ts){
        const d = new Date(ts);
        return d.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
      }

      function renderMessages(){
        const arr = loadMessages();
        messagesEl.innerHTML = '';
        for(const m of arr){
          const wrapper = document.createElement('div');
          wrapper.className = 'msg' + (m.from === 'me' ? ' me' : '');
          const bubble = document.createElement('div');
          bubble.className = 'bubble' + (m.from === 'me' ? ' me' : '');
          bubble.innerHTML = `<div class="meta">${m.name} · ${formatTime(m.ts)}</div><div>${escapeHtml(m.text)}</div>`;
          wrapper.appendChild(bubble);
          messagesEl.appendChild(wrapper);
        }
        messagesEl.scrollTop = messagesEl.scrollHeight;
      }

      function renderUser(u){
        const leftAvatar = document.getElementById('leftAvatar');
        const leftName = document.getElementById('leftName');
        const leftEmail = document.getElementById('leftEmail');
        if(!u){
          leftAvatar.textContent = '?';
          leftName.textContent = 'Not signed in';
          leftEmail.textContent = 'Use "Login with Facebook" to continue';
          fbBtn.style.display = 'inline-block';
          logoutBtn.style.display = 'none';
        } else {
          leftAvatar.textContent = (u.name || '?').slice(0,2).toUpperCase();
          leftName.textContent = u.name || 'Unknown';
          leftEmail.textContent = u.email || '';
          fbBtn.style.display = 'none';
          logoutBtn.style.display = 'inline-block';
        }
      }

      function escapeHtml(s){
        return String(s).replace(/[&<>"]/g, (c)=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;' }[c]));
      }

      // handle send
      sendBtn.addEventListener('click', ()=>{
        const txt = input.value.trim();
        if(!txt) return;
        const user = loadUser() || {name:'Guest', email:''};
        const msg = {id: uid(), from:'me', name:user.name, text: txt, ts: Date.now()};
        addMessage(msg);
        input.value = '';
        // Simulate small auto-reply from "Ana" to make it interesting
        setTimeout(()=>{
          const reply = {id: uid(), from:'other', name:'Ana', text: generateReply(txt), ts: Date.now()};
          addMessage(reply);
        }, 700 + Math.random()*900);
      });

      input.addEventListener('keydown', (e)=>{
        if(e.key === 'Enter') sendBtn.click();
      });

      // Simple mock "Login with Facebook"
      fbBtn.addEventListener('click', ()=>{
        mockFacebookLogin();
      });

      logoutBtn.addEventListener('click', ()=>{
        clearUser();
      });

      function mockFacebookLogin(){
        // This opens a simple prompt to simulate the user info that FB would return.
        // In real app you'd call Facebook SDK + OAuth and get name/email/avatar from FB.
        const defaultName = 'Autobot ' + Math.floor(Math.random()*90 + 10);
        const name = prompt('Mock Facebook login — enter display name:', defaultName);
        if(!name) return;
        const email = prompt('Enter email to show (mock):', 'you@facebook.mock');
        const avatarInitials = (name.split(' ').map(x=>x[0]||'').slice(0,2).join('') || 'AU').toUpperCase();
        const user = {name, email, avatar: null, initials: avatarInitials};
        saveUser(user);
        // Optionally add a system message
        addMessage({id: uid(), from:'other', name:'System', text: `${name} signed in (mock).`, ts: Date.now()});
      }

      // Tiny auto reply generator (for demo)
      function generateReply(userText){
        const lower = userText.toLowerCase();
        if(lower.includes('hello')||lower.includes('hi')) return 'Hi! Kamusta? 😊';
        if(lower.includes('how') && lower.includes('you')) return 'Okay lang ako — ikaw?';
        if(lower.includes('facebook')) return 'Mock FB login is just for learning. Real FB requires an app id.';
        return ['Nice!','Got it.','Tapos mo na ba?','Cool 😎','Sige, continue.'][Math.floor(Math.random()*5)];
      }

      // Initialize page
      (function init(){
        renderUser(loadUser());
        renderMessages();
      })();

      // ====== REAL FACEBOOK LOGIN (commented) ======
      /*
      // To integrate real Facebook Login (actual users), follow these high-level steps:
      // 1. Create a Facebook App at https://developers.facebook.com/apps
      // 2. Configure the app: add "Facebook Login" product, set valid OAuth redirect URIs, and add your site's domain.
      // 3. Use Facebook SDK for JavaScript (load SDK script) and initialize:
      //
      // window.fbAsyncInit = function() {
      //   FB.init({
      //     appId      : '{your-app-id}',
      //     cookie     : true,
      //     xfbml      : true,
      //     version    : 'v17.0'
      //   });
      //   FB.AppEvents.logPageView();
      // };
      //
      // (load the SDK asynchronously)
      // (then) FB.login(function(response) {
      //   if (response.authResponse) {
      //     FB.api('/me', {fields: 'name,email,picture'}, function(profile) {
      //       // profile.name, profile.email, profile.picture.data.url
      //       // Save these to your session/backend and continue
      //     });
      //   } else {
      //     // user cancelled login or did not fully authorize.
      //   }
      // }, {scope: 'email'});
      //
      // Important notes:
      // - To run FB Login on production you need an HTTPS site and correct OAuth redirect URIs.
      // - Facebook App needs review for some permissions (email is usually fine without review).
      // - For real multi-user chat you need a backend (WebSocket, Firebase Realtime/Firestore, or server).
      */

    })();
  </script>
</body>
</html>
